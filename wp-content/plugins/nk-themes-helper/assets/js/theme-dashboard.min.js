(()=>{var e=window,t=e.jQuery,a=e.ajaxurl,n=e.EventSource,o=e.nkThemeDashboardOptions;t(".nk-drop").each((function(){new Drop({target:this,content:t(this).children(".nk-drop-cont").hide().html(),classes:"nk-drop-tether drop-theme-arrows drop-theme-twipsy",position:"bottom center",openOn:"hover"})}));var i=t("[data-nk-changelog]");if(i.length){var c=i.attr("data-nk-changelog"),s=i.find(".nk-theme-changelog-spinner").show(),r=i.find(".nk-theme-changelog-list"),d=i.find(".nk-theme-changelog-show-full-toggle");t.get(a,{action:"nkth_get_changelog",url:c},(function(e){if(s.remove(),e){var a=t("<div>").html(e);r.html(a.find(".ghostkit-changelog")),d.show()}else i.find(".nk-theme-changelog-not-loaded").show()})),d.on("click",(function(){d.remove(),r.css({"max-height":"none"})}))}var l,h,m,v=t(".about-description"),f=t(".nk-demos-list .button-demo"),k=0;function p(e,a){var o=a.find(".theme-progress").addClass("is-active").children(),i=a.find(".spinner").addClass("is-active"),c=new n(e);c.onmessage=function(n){var s=JSON.parse(n.data);switch(s.action){case"new_ajax":c.close(),setTimeout((function(){p(e,a)}),100);break;case"updateDelta":s.delta&&s.max_delta&&o.css("width","".concat(Math.max(0,Math.min(100,100*s.delta/s.max_delta)),"%"));break;case"complete":case"error":c.close(),f.removeAttr("disabled"),i.removeClass("is-active"),o.css("width","").parent().removeClass("is-active"),t(".nk-demos-list .theme.active").removeClass(".active"),v.children().hide(),"error"===s.action?v.children(".about-error").html(s.error).show():(a.addClass("active"),v.children(".about-success").show()),k=0}},c.onerror=function(e){console.error(e,this),v.html("Error: ".concat(this.readyState)),c.close(),k=0},c.addEventListener("log",(function(e){var t=JSON.parse(e.data);console.info(t.message)}))}t(".nk-demos-list").length&&(t(".nk-demos-list .theme-wrapper").append('<div class="nk-theme-demo-icon"></div>'),f.on("click",(function(e){if(e.preventDefault(),!k&&window.confirm(o.demoImportConfirm)){k=1,f.attr("disabled","disabled");var n=t(this).parents(".theme:eq(0)"),i=t(this).attr("data-demo");p("".concat(a,"?action=nkth_demo_import_action&demo_name=").concat(i),n)}})),t(window).on("beforeunload",(function(){if(k)return o.demoImportBeforeUnload}))),t("[data-nk-purchase-platform]").on("click",(function(){l||(l=1,t(this).attr("disabled","disabled").siblings(".spinner").addClass("is-active"),t.get(a,{action:"nkth_update_purchase_platform",platform:t(this).attr("data-nk-purchase-platform")},(function(e){"ok"!==e&&alert(e);var a=t("#nk-theme-purchase-platform-reload").val();window.location.href=a||window.location.href})))})),t("#nk-theme-activate").on("click",(function(){if(!h){var e=t("#nk-theme-activate-license").val(),n=t("#nk-theme-activate-token").val(),i=t("#nk-theme-refresh-token").val();e&&n&&i&&(h=1,t(this).attr("disabled","disabled").next(".spinner").addClass("is-active"),t.post(a,{action:"nkth_activation_action",ajax_nonce:o.ajax_nonce,type:"activate",code:e,token:n,refresh_token:i},(function(e){"ok"!==e&&alert(e);var a=t("#nk-theme-activate-reload").val();window.location.href=a||window.location.href})))}})),t("#nk-themefromsite-activation-toggle").on("click",(function(e){e.preventDefault();var a=t(this),n=a.parent();n.children("#nk-themefromsite-activate-license").show().focus(),n.children("#nk-themefromsite-activate").show(1),n.children(".button:eq(0)").add(a).hide()})),t("#nk-themefromsite-activate").on("click",(function(){if(!h){var e=t("#nk-themefromsite-activate-license"),n=e.val();n?(h=1,t(this).attr("disabled","disabled").next(".spinner").addClass("is-active"),t.post(a,{action:"nkth_activation_action",ajax_nonce:o.ajax_nonce,type:"activate",edd_license:n},(function(e){"ok"!==e&&alert(e);var a=t("#nk-themefromsite-activate-reload").val();window.location.href=a||window.location.href}))):e.focus()}})),t("#nk-theme-deactivate-license").on("click",(function(e){if(!m)if(window.confirm(o.deactivateTheme)){if(t(this).attr("href"))return;m=1,t(this).attr("disabled","disabled").next(".spinner").addClass("is-active"),t.post(a,{action:"nkth_activation_action",ajax_nonce:o.ajax_nonce,type:"deactivate"},(function(e){"ok"!==e&&alert(e);var a=t("#nk-theme-deactivate-reload").val();window.location.href=a||window.location.href}))}else e.preventDefault()})),t(".nk-theme-activation-notice").on("click",".notice-dismiss",(function(){t.post(a,{action:"nkth_ask_for_activation_disable"})})),t(".nk-theme-disable-leave-a-rating").on("click",(function(){t.post(a,{action:"nkth_ask_for_review_disable"}),t(this).closest(".nk-dashboard-widget").remove()}))})();